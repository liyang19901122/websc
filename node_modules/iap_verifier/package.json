{
  "name": "iap_verifier",
  "version": "0.0.5",
  "description": "iOS In App Purchase Receipt Verification library",
  "keywords": [
    "ios",
    "iap",
    "in app purchase",
    "iphone",
    "ipad",
    "verifier",
    "verify",
    "verify in app purchase"
  ],
  "homepage": "https://github.com/pcrawfor/iap_verifier",
  "author": {
    "name": "Paul Crawford",
    "email": "paul@cometcoast.com",
    "url": "http://cometcoast.com"
  },
  "main": "./lib/iap_verifier",
  "directories": {
    "lib": "./lib"
  },
  "repository": {
    "type": "git",
    "url": "https://github.com/pcrawfor/iap_verifier.git"
  },
  "engines": {
    "node": ">= 0.4.7"
  },
  "readme": "# IAPVerifier - Node.js verification library for iOS in app purchase receipts\n\n## Installation\n\nIAPVerifier is available via npm\n\n`npm install iap_verifier`\n\nIt has no external dependencies other than node itself.\n\n## Overview\n\nIAPVerifier takes an iOS In App purchase receipt string in it's raw string form and sends it to the Apple servers for verification, it then returns a response indicating whether the receipt is valid or not.\n\nThere are two environments for Apple's verification servers SandBox and Production, you can configure IAPVerifier to use either environment depending if you are testing your system or running it in production.\n\n### Usage\n  \nWhen instantiating the verifier you need to provide the itunes shared secret for the application you are verifying receipts for.  This can be found on the itunes connect page for the applications' in app purchases.\n  \nThe IAPVerifier API is very simple, create an instance of IAPVerifier and then call verifyReceipt on it with a callback.  The first argument is the receipt data string, the second is a boolean indicating whether or not the receipt data is encoded as base64 already or not the last argument is the callback which includes three parameters.\n\n    verifyReceipt(rawReceipt, function(isValid, message, data){\n      // do something with the verification info...      \n    });\n  \n    verifyAutoRenewReceipt(rawReceipt, function(isValid, message, data){\n      // do something with the verification info...\n    });\n    \nBoth the verifyReceipt and verifyAutorenewingReceipt take two parameters the rawReceipt string and a callback which has four params sent back to it, these are:\n\n* isValid - boolean indicating that the receipt has valid or the auto-renewing subscription is active\n* statusCode - the status code returned by Apple's server\n* message - the message associated in Apple's system with the statusCode\n* data - the receipt data returned by Apple's server\n\nThe callback function includes isValid which indicates whether the receipt is for a valid subscription/purchase, the statusCode returned by Apple's server and the Message associated with the statusCode.\n  \n#### To verify a receipt:\n\nJavascript:\n    \n    var IAPVerifier = require('iap_verifier');\n\n    // Verify a receipt\n    receipt = 'raw_receipt_data_from_ios'\n    \n    var client = new IAPVerifier(itunes_shared_secret);\n    client.verifyReceipt(receipt, function(valid, msg, data) {\n      if (valid) {\n        // update status of payment in your system\n        console.log(\"Valid receipt\");\n      } else {\n        console.log(\"Invalid receipt\");\n      }\n    });\n\nCoffeeScript:\n  \n    IAPVerifier = require('iap_verifier')\n\n    # Verify a receipt\n    receipt = 'raw_receipt_data_from_ios'\n\n    client = new IAPVerifier(itunes_shared_secret)\n    client.verifyReceipt receipt, (valid, msg, data) ->\n      if valid\n        console.log(\"Valid receipt\")\n      else\n        console.log(\"Invalid receipt\")            \n\n\nSimilarly you can verify auto-renewing receipts:\n\nJavascript:\n\n    // Verify an auto-renewing receipt\n    receipt = 'raw_receipt_data_from_ios'\n    \n    var client = new IAPVerifier('your_secret_key_from_itunes')\n    client.verifyAutorenewingReceipt(receipt, function(valid, msg, data){\n      if(valid) {\n        // update status of payment in your system\n      }\n    });\n\nCoffeeScript:\n  \n    # Verify an auto-renewing receipt\n    receipt = 'raw_receipt_data_from_ios'\n\n    client = new IAPVerifier('your_secret_key_from_itunes')\n    client.verifyAutorenewingReceipt receipt, (valid, msg, data) ->\n      if valid\n        console.log(\"Valid receipt\")\n      else\n        console.log(\"Invalid receipt\")\n\n### Special Note: Handling App Store reviews:\n\nThere is a special case for iOS In App Purchase verification that occurs during application review.  \n\nWhen you app is reviewed Apple is testing with a Distribution (production) build of your application however for testing reasons they use dns to fake out your app so that it thinks it's hitting the Production servers but is in fact hitting the Sandbox servers when processing In App purchases.  \n\nThis means when verifying receipts during a review you must failover to check receipts on the Sandbox environment, IAPVerifier does this automatically by checking the error codes sent back from Apple's server and auto-retrying the verification on the Sandbox environment if a Sandbox receipt has been sent to the Production environment.  This approach is recommended by Apple as the simplest way to handle these app store review receipts.\n\n### License\n\nSee LICENSE file.",
  "_id": "iap_verifier@0.0.5",
  "_from": "iap_verifier@*"
}
